# Sample stack configuration file for InteractiveAI CLI
#
# This file can be used with the global --cfg-file flag to provide organization and project
# context for all commands, and with 'iai services sync' for full service deployment.
#
# Usage examples:
#   iai services list --cfg-file stack-config.yaml
#   iai secrets list --cfg-file stack-config.yaml
#   iai services sync --cfg-file stack-config.yaml
#
# The organization and project fields are optional and provide defaults for all commands.
# The stack-id and services map are only required for the 'services sync' command.
#
# Note: The stack-id is used to group services together. Services with the same stack-id
# are managed as a unit. When syncing, the command will:
# - Create services that exist in the config but not in the project
# - Update services that exist in both
# - Delete services (with the same stack-id) that exist in the project but not in the config

organization: my-org
project: my-project
stack-id: my-stack-v1

services:
  # Example service with fixed replicas
  api-service:
    servicePort: 8080
    image:
      type: external
      repository: kennethreitz
      name: httpbin
      tag: latest
    resources:
      memory: "128Mi"
      cpu: "50m"
    env:
      - name: DATABASE_URL
        value: "postgres://db:5432/mydb"
      - name: LOG_LEVEL
        value: "info"
    secretRefs:
      - secretName: my-secret
    endpoint: true
    replicas: 2

  # Example service with autoscaling
  api-service-2:
    servicePort: 8080
    image:
      type: external
      repository: kennethreitz
      name: httpbin
      tag: latest
    resources:
      memory: "128Mi"
      cpu: "50m"
    env:
      - name: DATABASE_URL
        value: "postgres://db:5432/mydb"
      - name: LOG_LEVEL
        value: "info"
    secretRefs:
      - secretName: my-secret
    endpoint: true
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 10
      cpuPercentage: 80
      memoryPercentage: 85
